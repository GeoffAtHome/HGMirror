<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="title-card.html">
<link rel="import" href="popup-zone.html">
<link rel="import" href="zone-card.html">

<dom-module id="geniusmirror-app">
    <template>
        <style include="iron-flex iron-flex-alignment shared-styles">
             :host {
                display: block;
            }

            #dialog {
                width: 100%;
            }
        </style>
        <firebase-app api-key="AIzaSyC-wDzT4re8AFZekn5ot0S4A0oEmPfr1VU" auth-domain="heatgeniusmirror.firebaseapp.com" database-url="https://heatgeniusmirror.firebaseio.com"
            project-id="heatgeniusmirror" storage-bucket="heatgeniusmirror.appspot.com" messaging-sender-id="634253163682">
        </firebase-app>
        <firebase-document id="location" path="/data" data="{{data}}"></firebase-document>
        <app-indexeddb-mirror session="locations" key="data" data="{{data}}" persisted-data="{{persistedData}}"></app-indexeddb-mirror>
        <title-card data="[[data]]"></title-card>
        <div class="layout center-justified horizontal wrap">
            <template is="dom-repeat" items="[[persistedData.zones]]" as="zone">
                <zone-card zone="[[zone]]"></zone-card>
            </template>
        </div>
        <popup-zone id="timer"></popup-zone>
    </template>

    <script>
        /**
         * @customElement
         * @polymer
         */
        class GeniusmirrorApp extends Polymer.Element {
            static get is() {
                return 'geniusmirror-app';
            }
            static get properties() {
                return {
                    data: Object,
                    persistedData: Object,
                    initialized: Object
                };
            }

            ready() {
                super.ready();
                window.addEventListener('showTimer', () => this._showTimer(event));
            }

            _showTimer(event) {
                console.log("Show timer");
                this.$.timer.zone = event.detail;
            }
        }

        window.customElements.define(GeniusmirrorApp.is, GeniusmirrorApp);
    </script>
</dom-module>